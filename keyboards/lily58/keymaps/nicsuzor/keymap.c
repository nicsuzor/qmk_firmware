#include QMK_KEYBOARD_H
#include "nic.h"

//#include "lufa.h"
#include "split_util.h"
#ifdef SSD1306OLED
  #include "ssd1306.h"
#endif

#ifdef RGBLIGHT_ENABLE
//Following line allows macro to read current RGB settings
extern rgblight_config_t rgblight_config;
#endif


#ifdef RGB_MATRIX_ENABLE

extern led_config_t g_led_config;


  // Logical Layout
  // Columns
  // Left
  // 0  1  2  3  4  5
  //                   ROWS
  // 25 24 19 18 11 10   0
  //    03    02    01
  // 26 23 20 17 12 09   1
  //    04    05    06
  // 27 22 21 16 13 08   2
  //
  //          15 14 07   3
  //
  // Right
  // 0  1  2  3  4  5
  //                    ROWS
  // 25 24 19 18 11 10   4
  //    03    02    01
  // 26 23 20 17 12 09   5
  //    04    05    06
  // 27 22 21 16 13 08   6
  //
  //          15 14 07   7
  //
  // Physical Layout
  // Columns
  // 0  1  2  3  4  5  6  7  8  9  10 11 12 13
  //                                           ROWS
  // 25 24 19 18 11 10       10 11 18 19 24 25  0
  //    03    02    01       01    02    03
  // 26 23 20 17 12 09       09 12 17 20 23 26  1
  //    04                               04
  // 27 22 21 16 13 08       08 13 16 21 22 27  2
  //          05    06       06    05
  //           15 14 07     07 14 15              3

led_config_t g_led_config = { {
    { 12, 11, 10, 9, 8, 7 },
    {  18, 17, 16, 15, 14, 13 },
    {  24,  23,  22,  21,  20, 19 },
    {  30,  29,  28, 27, 26, 25 },
    { NO_LED, 35, 34, 33, 32, 31 },
     {  41,  40,  39,  38,  37,  36 },
    { 47, 46, 45, 44, 43, 42 },
    {  53, 52, 51, 50, 49, 48},
    { 60, 59, 58, 57, 56, 54,},
    { NO_LED, 65, 64, 63, 62, 61},
}, {
    {  85,  16 }, {  50,  13 }, {  16,  20 }, {  16,  38 }, {  50,  48 }, {  85,  52 }, {  95,  63 },
    {  85,  39 }, {  85,  21 }, {  85,   4 }, {  68,   2 }, {  68,  19 }, {  68,  37 }, {  80,  58 },
    {  60,  55 }, {  50,  35 }, {  50,  13 }, {  50,   0 }, {  33,   3 }, {  33,  20 }, {  33,  37 },
    {  16,  42 }, {  16,  24 }, {  16,   7 }, {   0,   7 }, {   0,  24 }, {   0,  41 }, { 139,  16 },
    { 174,  13 }, { 208,  20 }, { 208,  38 }, { 174,  48 }, { 139,  52 }, { 129,  63 }, { 139,  39 },
    { 139,  21 }, { 139,   4 }, { 156,   2 }, { 156,  19 }, { 156,  37 }, { 144,  58 }, { 164,  55 },
    { 174,  35 }, { 174,  13 }, { 174,   0 }, { 191,   3 }, { 191,  20 }, { 191,  37 }, { 208,  42 },
    { 208,  24 }, { 208,   7 }, { 224,   7 }, { 224,  24 }, { 224,  41 }, { 139,  52 }, { 139,  52 },
         { 208,  24 }, { 208,   7 }, { 224,   7 }, { 224,  24 }
}, {
    2, 2, 2, 2, 2, 2,
    4, 4, 4, 4, 4, 4,
    4, 4, 4, 4, 4, 4,
    4, 4, 4, 4, 4, 4,
    4, 4, 4, 4, 4, 4,

    2, 2, 2, 2, 2, 2,
    4, 4, 4, 4, 4, 4,
    4, 4, 4, 4, 4, 4,
    4, 4, 4, 4, 4, 4,
    4, 4, 4, 4, 4, 4
} };

#endif


extern uint8_t is_master;

// clang-format off
#define LAYOUT_LILY( \
	L00, L01, L02, L03, L04, L05,           R00, R01, R02, R03, R04, R05,  \
	L10, L11, L12, L13, L14, L15,           R10, R11, R12, R13, R14, R15,  \
	L20, L21, L22, L23, L24, L25,           R20, R21, R22, R23, R24, R25,  \
	L30, L31, L32, L33, L34, L35, L45, R40, R30, R31, R32, R33, R34, R35, \
	               L41, L42, L43, L44, R41, R42, R43, R44  \
	) \
    { \
		{ L00, L01, L02, L03, L04, L05 }, \
		{ L10, L11, L12, L13, L14, L15 }, \
		{ L20, L21, L22, L23, L24, L25 }, \
		{ L30, L31, L32, L33, L34, L35 }, \
		{ KC_NO, L41, L42, L43, L44, L45 }, \
		{ KC_BSPC, R04, R03, R02, R01, R00 }, \
		{ KC_F17, R14, R13, R12, R11, R10 }, \
		{ R25, R24, R23, R22, R21, R20 }, \
		{ R35, R34, R33, R32, R31, R30 }, \
		{ KC_NO, R44, R43, R42, R41, R40 } \
    }

#define LAYOUT_lily_base_wrapper(...)       LAYOUT_LILY(__VA_ARGS__)

const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {
[_QWERTY] = LAYOUT_lily_base_wrapper(
    ________________NUMBER_LEFT________________,                ________________NUMBER_RIGHT_______________,
    _________________QWERTY_L1_________________,                _________________QWERTY_R1_________________,
    _________________QWERTY_L2_________________,                _________________QWERTY_R2_________________,
    _________________QWERTY_L3_________________, DEBUG, DEBUG, _________________QWERTY_R3_________________,
    EPRM, KC_LALT, KC_LCTL, LT(_LOWER, KC_SPC), LT(_RAISE, KC_BSPC), KC_DEL, KC_RGUI, EPRM
),

[_LOWER] = LAYOUT_lily_base_wrapper(
    _________________LOWER_L1__________________,                _________________LOWER_R1__________________,
    _________________LOWER_L2__________________,                _________________LOWER_R2__________________,
    _________________LOWER_L3__________________,                _________________LOWER_R3__________________,
    _________________LOWER_L4__________________, KC_TRNS, KC_TRNS, _________________LOWER_R4__________________,
                KC_TRNS, KC_TRNS, KC_TRNS, KC_TRNS, KC_TRNS, KC_TRNS, KC_TRNS, KC_TRNS
),

[_RAISE] = LAYOUT_lily_base_wrapper(
    _________________RAISE_L1__________________,                _________________RAISE_R1__________________,
    _________________RAISE_L2__________________,                _________________RAISE_R2__________________,
    _________________RAISE_L3__________________,                _________________RAISE_R3__________________,
    _________________RAISE_L4__________________, KC_TRNS, KC_TRNS, _________________RAISE_R4__________________,
                    KC_TRNS, KC_TRNS, KC_TRNS, KC_TRNS, KC_TRNS, KC_TRNS, KC_TRNS, KC_TRNS
),

[_ADJUST] = LAYOUT_lily_base_wrapper(
    ________________NUMBER_LEFT________________,                    ________________NUMBER_RIGHT_______________,
    _________________ADJUST_L1_________________,                    _________________ADJUST_R1_________________,
    _________________ADJUST_L2_________________,                    _________________ADJUST_R2_________________,
    _________________ADJUST_L3_________________, KC_TRNS, TO(0),    _________________ADJUST_R3_________________,
                     _______, _______, _______,   _______, _______,      _______, _______, _______
)
};
  